<!DOCTYPE html>
<html>
<head>
  <title>Fee Billing Panel</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f0f0f0;
      padding: 30px;
    }
    form {
      background: white;
      padding: 20px;
      border-radius: 8px;
      max-width: 600px;
      margin: auto;
    }
    label, input, select {
      display: block;
      width: 100%;
      margin-bottom: 10px;
    }
    button {
      background-color: navy;
      color: white;
      padding: 10px;
      border: none;
      cursor: pointer;
    }
    button:hover {
      background-color: goldenrod;
    }
  </style>
</head>
<body>

  <form id="billing-form">
    <h2>Fee Billing</h2>

    <label>Bill Date</label>
    <input type="date" id="billDate" name="billDate" required>

    <label>Class</label>
    <input type="text" name="class" required>

    <label>Student ID</label>
    <input type="text" name="studentId" required>

    <label>Student Name</label>
    <input type="text" name="studentName" required>

    <label>Fee Plan</label>
    <input type="text" name="feePlan" required>

    <label>Class Start Date</label>
    <input type="date" name="classStartDate" required>

    <label>Days Purchased</label>
    <input type="number" name="daysPurchased" required>

    <label>Total Fee</label>
    <input type="number" name="totalFee" required>

    <label>Paid Amount</label>
    <input type="number" name="paidAmount" required>

    <label>Balance</label>
    <input type="number" name="balance" required>

    <label>Payment Mode</label>
    <select name="paymentMode" required>
      <option value="Cash">Cash</option>
      <option value="UPI">UPI</option>
      <option value="Card">Card</option>
    </select>

    <label>Remarks</label>
    <input type="text" name="remarks">

    <label>Payment Status</label>
    <select name="paymentStatus" required>
      <option value="Paid">Paid</option>
      <option value="Partially Paid">Partially Paid</option>
      <option value="Pending">Pending</option>
    </select>

    <button type="button" onclick="submitForm()">Save to Sheet</button>
  </form>

  <script>
    document.getElementById('billDate').valueAsDate = new Date();

    function submitForm() {
      const form = document.getElementById('billing-form');
      const formData = new FormData(form);
      const obj = {};
      formData.forEach((val, key) => obj[key] = val);

      fetch('https://script.google.com/macros/s/AKfycbz933abjmypGrajkrRn3G42SvjRgucCWnuttzDOTcnU24yFpqlFT9V1PJ1OZ0U664Kw/exec', {
        method: 'POST',
        body: JSON.stringify(obj),
        headers: { 'Content-Type': 'application/json' }
      })
      .then(res => res.json())
      .then(data => {
        alert(data.result === "Success" ? "Saved successfully!" : "Error: " + data.message);
      })
      .catch(err => alert("Error saving: " + err));
    }
  </script>

</body>
</html>
