<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Weekly Reports</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f9f9f9;
      margin: 20px;
    }
    h2 {
      color: navy;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      background: white;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      border-radius: 8px;
    }
    thead {
      background-color: #FFD700; /* golden yellow */
      color: black;
    }
    th, td {
      padding: 12px 15px;
      border: 1px solid navy;
      text-align: left;
    }
    tr:hover {
      background-color: #f1f1f1;
    }
    .view-btn {
      background-color: navy;
      color: white;
      padding: 6px 12px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    .modal {
      display: none;
      position: fixed;
      z-index: 10;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.6);
    }
    .modal-content {
      background: white;
      margin: 10% auto;
      padding: 20px;
      border-radius: 10px;
      width: 70%;
      box-shadow: 0 4px 20px rgba(0,0,0,0.5);
    }
    .close-btn {
      float: right;
      font-size: 18px;
      font-weight: bold;
      color: red;
      cursor: pointer;
    }
  </style>
</head>
<body>

  <h2>Admin - Weekly Reports</h2>
  <table id="reportTable">
    <thead>
      <tr>
        <th>Date</th>
        <th>Report Title</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <!-- Modal Popup -->
  <div class="modal" id="reportModal">
    <div class="modal-content">
      <span class="close-btn" onclick="closeModal()">Ã—</span>
      <h3 id="modalTitle"></h3>
      <p><strong>Start Date:</strong> <span id="modalStart"></span></p>
      <p><strong>End Date:</strong> <span id="modalEnd"></span></p>
      <p><strong>Activity Summary:</strong> <span id="modalActivity"></span></p>
      <p><strong>Achievements:</strong> <span id="modalAchievements"></span></p>
      <p><strong>Challenges:</strong> <span id="modalChallenges"></span></p>
      <p><strong>Plans for Next Week:</strong> <span id="modalPlans"></span></p>
    </div>
  </div>

  <script>
    const SHEET_URL = "https://script.google.com/macros/s/AKfycbzWrKgb5w4G7lOHXRwbaHL_sGx3LR3jC_7XleQL1Hg57Sl0fzw2acNGiusDjHzktRW4xg/exec";

    fetch(SHEET_URL)
      .then(res => res.json())
      .then(data => {
        const tableBody = document.querySelector("#reportTable tbody");
        data.forEach((row, index) => {
          const tr = document.createElement("tr");
          tr.innerHTML = `
            <td>${row.startDate} to ${row.endDate}</td>
            <td>${row.reportTitle}</td>
            <td><button class="view-btn" onclick='viewReport(${JSON.stringify(row)})'>View</button></td>
          `;
          tableBody.appendChild(tr);
        });
      });

    function viewReport(report) {
      document.getElementById("modalTitle").textContent = report.reportTitle;
      document.getElementById("modalStart").textContent = report.startDate;
      document.getElementById("modalEnd").textContent = report.endDate;
      document.getElementById("modalActivity").textContent = report.activitySummary;
      document.getElementById("modalAchievements").textContent = report.achievements;
      document.getElementById("modalChallenges").textContent = report.challenges;
      document.getElementById("modalPlans").textContent = report.plansNextWeek;
      document.getElementById("reportModal").style.display = "block";
    }

    function closeModal() {
      document.getElementById("reportModal").style.display = "none";
    }
  </script>
</body>
</html>
