<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Weekly Reports</title>
  <style>
    <button class="dashboard-btn" onclick="goToDashboard()">← Dashboard</button>
  body {
    font-family: Arial, sans-serif;
    background: #f4f4f4;
    margin: 20px;
  }
  h2 {
    color: navy;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    background: white;
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    border-radius: 8px;
  }
  thead {
    background-color: #FFD700;
    color: black;
  }
  th, td {
    padding: 12px 15px;
    border: 1px solid navy;
    text-align: left;
  }
  tr:hover {
    background-color: #f1f1f1;
  }
  .view-btn {
    background-color: navy;
    color: white;
    padding: 6px 12px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
  }

  /* Modal Styles */
  .modal {
    display: none;
    position: fixed;
    z-index: 10;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.6);
  }
 .modal-content {
  background: white;
  margin: 5% auto;
  padding: 30px;
  border-radius: 15px;
  width: 80%;
  max-width: 850px;
  max-height: 80vh;
  overflow-y: auto;
  box-shadow: 0 10px 30px rgba(0,0,0,0.3);
  position: relative;
  scrollbar-width: thin;
  scrollbar-color: navy #f1f1f1;
}

/* Scrollbar for Chrome/Edge */
.modal-content::-webkit-scrollbar {
  width: 8px;
}
.modal-content::-webkit-scrollbar-thumb {
  background-color: navy;
  border-radius: 10px;
}
.modal-content::-webkit-scrollbar-track {
  background-color: #f1f1f1;
  border-radius: 10px;
}

  .close-btn {
    position: absolute;
    right: 20px;
    top: 15px;
    font-size: 20px;
    font-weight: bold;
    color: red;
    cursor: pointer;
  }

  .report-box {
    background: #ffffff;
    border: 2px solid navy;
    border-radius: 15px;
    padding: 15px 20px;
    margin-bottom: 15px;
    box-shadow: 2px 4px 10px rgba(0,0,0,0.1);
  }

  .report-section {
  border: 2px solid navy;
  border-radius: 15px;
  padding: 20px;
  margin-bottom: 20px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  background-color: #fff;
}

.report-section h3 {
  background-color: #FFD700;
  color: navy;
  padding: 10px 15px;
  border-radius: 10px 10px 0 0;
  margin-top: 0;
  font-size: 18px;
}

.report-section p {
  margin: 10px 0 0 0;
  padding: 0 5px;
  color: #333;
}

    .dashboard-btn {
  background-color: #FFD700;
  color: navy;
  border: 2px solid navy;
  border-radius: 8px;
  padding: 10px 20px;
  font-weight: bold;
  cursor: pointer;
  box-shadow: 2px 4px 8px rgba(0,0,0,0.2);
  margin-bottom: 20px;
  transition: all 0.3s ease;
}
.dashboard-btn:hover {
  background-color: navy;
  color: #FFD700;
}

</style>

</head>
<body>

  <h2>Admin - Weekly Reports</h2>
  <table id="reportTable">
    <thead>
      <tr>
        <th>Date</th>
        <th>Report Title</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

 <!-- Modal Popup -->
<div class="modal" id="reportModal">
  <div class="modal-content">
    <span class="close-btn" onclick="closeModal()">×</span>
    <div class="report-title" id="modalTitle"></div>

    <div class="report-box">
      <h4>Date Range</h4>
      <p><span id="modalStart"></span> to <span id="modalEnd"></span></p>
    </div>

    <div class="report-box">
      <h4>Activity Summary</h4>
      <p id="modalActivity"></p>
    </div>

    <div class="report-box">
      <h4>Achievements</h4>
      <p id="modalAchievements"></p>
    </div>

    <div class="report-box">
      <h4>Challenges</h4>
      <p id="modalChallenges"></p>
    </div>

    <div class="report-box">
      <h4>Plans for Next Week</h4>
      <p id="modalPlans"></p>
    </div>
  </div>
</div>


<script>
  const SHEET_URL = "https://script.google.com/macros/s/AKfycbzWrKgb5w4G7lOHXRwbaHL_sGx3LR3jC_7XleQL1Hg57Sl0fzw2acNGiusDjHzktRW4xg/exec";

  // Fetch and display the table
  fetch(SHEET_URL)
    .then(res => res.json())
    .then(data => {
      const tableBody = document.querySelector("#reportTable tbody");
      data.forEach((row, index) => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${formatDate(row.startDate)} to ${formatDate(row.endDate)}</td>
          <td>${row.reportTitle || "Untitled"}</td>
          <td><button class="view-btn" onclick='viewReport(${JSON.stringify(row)})'>View</button></td>
        `;
        tableBody.appendChild(tr);
      });
    });

  // Format date to DD MMM YYYY
  function formatDate(dateStr) {
    const date = new Date(dateStr);
    const options = { day: '2-digit', month: 'short', year: 'numeric' };
    return date.toLocaleDateString('en-GB', options);
  }

  // Show report in modal
  function viewReport(report) {
    document.getElementById("modalTitle").textContent = `Weekly Report: ${formatDate(report.startDate)} to ${formatDate(report.endDate)}`;

    const modalBody = document.getElementById("modal-body");

    const html = `
      <div class="report-section">
        <h3>Start Date</h3><p>${formatDate(report.startDate)}</p>
      </div>
      <div class="report-section">
        <h3>End Date</h3><p>${formatDate(report.endDate)}</p>
      </div>
      <div class="report-section">
        <h3>Report Title</h3><p>${report.reportTitle || "Not provided"}</p>
      </div>
      <div class="report-section">
        <h3>Activity Summary</h3><p>${report.activitySummary || "Not provided"}</p>
      </div>
      <div class="report-section">
        <h3>Achievements</h3><p>${report.achievements || "Not provided"}</p>
      </div>
      <div class="report-section">
        <h3>Challenges</h3><p>${report.challenges || "Not provided"}</p>
      </div>
      <div class="report-section">
        <h3>Plans for Next Week</h3><p>${report.plansNextWeek || "Not provided"}</p>
      </div>
    `;

    modalBody.innerHTML = html;
    document.getElementById("reportModal").style.display = "block";
  }

  // Close modal
  function closeModal() {
    document.getElementById("reportModal").style.display = "none";
  }

  // Go to Dashboard
  function goToDashboard() {
    window.location.href = "admin_dashboard.html";
  }
</script>

</body>

</html>
