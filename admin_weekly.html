<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Weekly Reports</title>
  <style>
  body {
    font-family: Arial, sans-serif;
    background: #f4f4f4;
    margin: 20px;
  }
  h2 {
    color: navy;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    background: white;
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    border-radius: 8px;
  }
  thead {
    background-color: #FFD700;
    color: black;
  }
  th, td {
    padding: 12px 15px;
    border: 1px solid navy;
    text-align: left;
  }
  tr:hover {
    background-color: #f1f1f1;
  }
  .view-btn {
    background-color: navy;
    color: white;
    padding: 6px 12px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
  }

  /* Modal Styles */
  .modal {
    display: none;
    position: fixed;
    z-index: 10;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.6);
  }
  .modal-content {
    background: white;
    margin: 5% auto;
    padding: 20px;
    border-radius: 15px;
    width: 80%;
    max-width: 800px;
    box-shadow: 0 8px 30px rgba(0,0,0,0.3);
    position: relative;
  }
  .close-btn {
    position: absolute;
    right: 20px;
    top: 15px;
    font-size: 20px;
    font-weight: bold;
    color: red;
    cursor: pointer;
  }

  .report-box {
    background: #ffffff;
    border: 2px solid navy;
    border-radius: 15px;
    padding: 15px 20px;
    margin-bottom: 15px;
    box-shadow: 2px 4px 10px rgba(0,0,0,0.1);
  }

  .report-box h4 {
    margin: 0 0 8px;
    color: #FFD700;
    font-weight: bold;
    border-bottom: 1px solid #ccc;
    padding-bottom: 5px;
  }

  .report-title {
    font-size: 20px;
    font-weight: bold;
    color: navy;
    margin-bottom: 10px;
  }
</style>

</head>
<body>

  <h2>Admin - Weekly Reports</h2>
  <table id="reportTable">
    <thead>
      <tr>
        <th>Date</th>
        <th>Report Title</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

 <!-- Modal Popup -->
<div class="modal" id="reportModal">
  <div class="modal-content">
    <span class="close-btn" onclick="closeModal()">Ã—</span>
    <div class="report-title" id="modalTitle"></div>

    <div class="report-box">
      <h4>Date Range</h4>
      <p><span id="modalStart"></span> to <span id="modalEnd"></span></p>
    </div>

    <div class="report-box">
      <h4>Activity Summary</h4>
      <p id="modalActivity"></p>
    </div>

    <div class="report-box">
      <h4>Achievements</h4>
      <p id="modalAchievements"></p>
    </div>

    <div class="report-box">
      <h4>Challenges</h4>
      <p id="modalChallenges"></p>
    </div>

    <div class="report-box">
      <h4>Plans for Next Week</h4>
      <p id="modalPlans"></p>
    </div>
  </div>
</div>


  <script>
    const SHEET_URL = "https://script.google.com/macros/s/AKfycbzWrKgb5w4G7lOHXRwbaHL_sGx3LR3jC_7XleQL1Hg57Sl0fzw2acNGiusDjHzktRW4xg/exec";

    fetch(SHEET_URL)
      .then(res => res.json())
      .then(data => {
        const tableBody = document.querySelector("#reportTable tbody");
        data.forEach((row, index) => {
          const tr = document.createElement("tr");
          tr.innerHTML = `
            <td>${row.startDate} to ${row.endDate}</td>
            <td>${row.reportTitle}</td>
            <td><button class="view-btn" onclick='viewReport(${JSON.stringify(row)})'>View</button></td>
          `;
          tableBody.appendChild(tr);
        });
      });

 function formatDate(dateStr) {
  const date = new Date(dateStr);
  const options = { day: '2-digit', month: 'short', year: 'numeric' };
  return date.toLocaleDateString('en-GB', options);
}

function viewReport(report) {
  document.getElementById("modalTitle").textContent = `Weekly Report: ${formatDate(report.startDate)} to ${formatDate(report.endDate)}`;
  document.getElementById("modalStart").textContent = formatDate(report.startDate);
  document.getElementById("modalEnd").textContent = formatDate(report.endDate);
  document.getElementById("modalActivity").textContent = report.activitySummary || "Not provided";
  document.getElementById("modalAchievements").textContent = report.achievements || "Not provided";
  document.getElementById("modalChallenges").textContent = report.challenges || "Not provided";
  document.getElementById("modalPlans").textContent = report.plansNextWeek || "Not provided";
  document.getElementById("reportModal").style.display = "block";
}


    function closeModal() {
      document.getElementById("reportModal").style.display = "none";
    }
  </script>
</body>
</html>
