<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Timetable Entry</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background: #f5f7fa;
    }
    h2 {
      color: #2c3e50;
    }
    label {
      margin-right: 10px;
    }
    input, select, button {
      margin: 5px;
      padding: 6px;
    }
    table {
      width: 100%;
      margin-top: 20px;
      border-collapse: collapse;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 8px;
    }
    th {
      background-color: #2c3e50;
      color: white;
    }
    tr:nth-child(even) {
      background-color: #f2f2f2;
    }
  </style>
</head>
<body>
  <h2>Weekly Timetable Entry</h2>

  <label>Week Start:</label>
  <input type="date" id="weekStart"><br>
  <label>Student ID:</label>
  <input type="text" id="studentId"><br>
  <label>Student Name:</label>
  <input type="text" id="studentName"><br><br>

  <label>Day:</label>
  <select id="day">
    <option value="Monday">Monday</option>
    <option value="Tuesday">Tuesday</option>
    <option value="Wednesday">Wednesday</option>
    <option value="Thursday">Thursday</option>
    <option value="Friday">Friday</option>
    <option value="Saturday">Saturday</option>
  </select>

  <label>Time:</label>
  <input type="text" id="time" placeholder="e.g. 10:00 AM - 11:00 AM">

  <label>Subject:</label>
  <input type="text" id="subject">

  <label>Teacher:</label>
  <input type="text" id="teacher">

  <label>Link:</label>
  <input type="text" id="link">

  <button onclick="addEntry()">Add Entry</button>
  <button onclick="submitData()">Submit Timetable</button>

  <table id="entryTable">
    <thead>
      <tr>
        <th>Day</th>
        <th>Time</th>
        <th>Subject</th>
        <th>Teacher</th>
        <th>Link</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    const entries = [];

    function addEntry() {
      const day = document.getElementById("day").value;
      const time = document.getElementById("time").value;
      const subject = document.getElementById("subject").value;
      const teacher = document.getElementById("teacher").value;
      const link = document.getElementById("link").value;

      if (!day || !time || !subject || !teacher) {
        alert("Please fill in all fields.");
        return;
      }

      const entry = { day, time, subject, teacher, link };
      entries.push(entry);

      const tableBody = document.getElementById("entryTable").getElementsByTagName("tbody")[0];
      const row = tableBody.insertRow();
      row.insertCell(0).innerText = day;
      row.insertCell(1).innerText = time;
      row.insertCell(2).innerText = subject;
      row.insertCell(3).innerText = teacher;
      row.insertCell(4).innerText = link;

      // Clear inputs
      document.getElementById("time").value = "";
      document.getElementById("subject").value = "";
      document.getElementById("teacher").value = "";
      document.getElementById("link").value = "";
    }

    async function submitData() {
      const weekStart = document.getElementById("weekStart").value;
      const studentId = document.getElementById("studentId").value;
      const studentName = document.getElementById("studentName").value;

      if (!weekStart || !studentId || !studentName || entries.length === 0) {
        alert("Please fill all fields and add at least one entry.");
        return;
      }

      try {
        const response = await fetch("AKfycbxJ-IGsjzrqUlykZEgK_BtLtz4O7BCF8tv8_Hus1dOENrN_Wnr0NzTAT38KMGamy-XJlQ", {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify({
            weekStart,
            studentId,
            studentName,
            entries
          })
        });

        if (response.ok) {
          alert("Timetable submitted successfully!");
          location.reload();
        } else {
          alert("Error submitting timetable.");
        }
      } catch (err) {
        console.error(err);
        alert("Failed to submit timetable.");
      }
    }
  </script>
</body>
</html>
